<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Advanced Filters Test - Mentora</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Arial', sans-serif; }
  </style>
</head>
<body class="bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 min-h-screen text-white">
  <div class="max-w-7xl mx-auto py-8 px-4">
    <h1 class="text-3xl font-bold mb-8 text-cyan-300 text-center">Advanced Multi-Select Filters Test</h1>
    
    <!-- Status Display -->
    <div id="test-status" class="mb-6 p-4 bg-blue-500/20 border border-blue-400/30 rounded-xl text-center">
      <h2 class="text-xl font-semibold text-blue-300 mb-2">Test Status</h2>
      <div id="status-content" class="text-blue-200">
        <p>‚úÖ Page loaded successfully</p>
        <p>üîÑ Initializing filters...</p>
      </div>
    </div>

    <!-- Advanced Manual Filters -->
    <div id="advanced-filters" class="mb-6 p-6 bg-gray-800/50 backdrop-blur-sm border border-gray-700/50 rounded-2xl shadow-xl">
      <div class="flex flex-col lg:flex-row items-start lg:items-center justify-between mb-4">
        <h3 class="text-xl font-bold text-cyan-300 mb-2 lg:mb-0">Advanced Manual Filters</h3>
        <button id="clear-all-filters" class="px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white text-sm rounded-lg transition-all duration-300 hover:scale-105">
          Clear All
        </button>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <!-- Multi-select Subjects -->
        <div class="filter-group">
          <label class="block text-sm font-medium text-gray-300 mb-2">Subjects</label>
          <div class="multi-select-container relative">
            <button id="subjects-dropdown-btn" class="w-full flex items-center justify-between px-3 py-2 bg-white/10 backdrop-blur-sm border border-cyan-400/50 rounded-lg text-white hover:bg-white/20 focus:bg-white/20 focus:border-cyan-400 focus:outline-none focus:ring-2 focus:ring-cyan-400/30 transition-all duration-150">
              <span id="subjects-display" class="text-sm truncate">Select subjects...</span>
              <svg class="w-4 h-4 text-cyan-400 transform transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </button>
            <div id="subjects-dropdown" class="absolute z-10 w-full mt-1 bg-gray-800 border border-gray-600 rounded-lg shadow-lg hidden max-h-40 overflow-y-auto">
              <label class="flex items-center px-3 py-2 hover:bg-gray-700 cursor-pointer">
                <input type="checkbox" value="math" class="subject-filter mr-2">
                <span>Math</span>
              </label>
              <label class="flex items-center px-3 py-2 hover:bg-gray-700 cursor-pointer">
                <input type="checkbox" value="english" class="subject-filter mr-2">
                <span>English</span>
              </label>
              <label class="flex items-center px-3 py-2 hover:bg-gray-700 cursor-pointer">
                <input type="checkbox" value="science" class="subject-filter mr-2">
                <span>Science</span>
              </label>
            </div>
          </div>
        </div>

        <!-- Multi-select Availability -->
        <div class="filter-group">
          <label class="block text-sm font-medium text-gray-300 mb-2">Availability</label>
          <div class="multi-select-container relative">
            <button id="availability-dropdown-btn" class="w-full flex items-center justify-between px-3 py-2 bg-white/10 backdrop-blur-sm border border-cyan-400/50 rounded-lg text-white hover:bg-white/20 focus:bg-white/20 focus:border-cyan-400 focus:outline-none focus:ring-2 focus:ring-cyan-400/30 transition-all duration-150">
              <span id="availability-display" class="text-sm truncate">Select times...</span>
              <svg class="w-4 h-4 text-cyan-400 transform transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </button>
            <div id="availability-dropdown" class="absolute z-10 w-full mt-1 bg-gray-800 border border-gray-600 rounded-lg shadow-lg hidden max-h-40 overflow-y-auto">
              <label class="flex items-center px-3 py-2 hover:bg-gray-700 cursor-pointer">
                <input type="checkbox" value="morning" class="availability-filter mr-2">
                <span>Morning (8:00-12:00)</span>
              </label>
              <label class="flex items-center px-3 py-2 hover:bg-gray-700 cursor-pointer">
                <input type="checkbox" value="afternoon" class="availability-filter mr-2">
                <span>Afternoon (12:00-17:00)</span>
              </label>
              <label class="flex items-center px-3 py-2 hover:bg-gray-700 cursor-pointer">
                <input type="checkbox" value="evening" class="availability-filter mr-2">
                <span>Evening (17:00-22:00)</span>
              </label>
              <label class="flex items-center px-3 py-2 hover:bg-gray-700 cursor-pointer">
                <input type="checkbox" value="weekdays" class="availability-filter mr-2">
                <span>Weekdays</span>
              </label>
              <label class="flex items-center px-3 py-2 hover:bg-gray-700 cursor-pointer">
                <input type="checkbox" value="weekends" class="availability-filter mr-2">
                <span>Weekends</span>
              </label>
            </div>
          </div>
        </div>

        <!-- Multi-select Languages -->
        <div class="filter-group">
          <label class="block text-sm font-medium text-gray-300 mb-2">Languages</label>
          <div class="multi-select-container relative">
            <button id="languages-dropdown-btn" class="w-full flex items-center justify-between px-3 py-2 bg-white/10 backdrop-blur-sm border border-cyan-400/50 rounded-lg text-white hover:bg-white/20 focus:bg-white/20 focus:border-cyan-400 focus:outline-none focus:ring-2 focus:ring-cyan-400/30 transition-all duration-150">
              <span id="languages-display" class="text-sm truncate">Select languages...</span>
              <svg class="w-4 h-4 text-cyan-400 transform transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </button>
            <div id="languages-dropdown" class="absolute z-10 w-full mt-1 bg-gray-800 border border-gray-600 rounded-lg shadow-lg hidden max-h-40 overflow-y-auto">
              <label class="flex items-center px-3 py-2 hover:bg-gray-700 cursor-pointer">
                <input type="checkbox" value="English" class="language-filter mr-2">
                <span>English</span>
              </label>
              <label class="flex items-center px-3 py-2 hover:bg-gray-700 cursor-pointer">
                <input type="checkbox" value="Spanish" class="language-filter mr-2">
                <span>Spanish</span>
              </label>
              <label class="flex items-center px-3 py-2 hover:bg-gray-700 cursor-pointer">
                <input type="checkbox" value="French" class="language-filter mr-2">
                <span>French</span>
              </label>
            </div>
          </div>
        </div>

        <!-- Multi-select Hobbies -->
        <div class="filter-group">
          <label class="block text-sm font-medium text-gray-300 mb-2">Hobbies/Interests</label>
          <div class="multi-select-container relative">
            <button id="hobbies-dropdown-btn" class="w-full flex items-center justify-between px-3 py-2 bg-white/10 backdrop-blur-sm border border-cyan-400/50 rounded-lg text-white hover:bg-white/20 focus:bg-white/20 focus:border-cyan-400 focus:outline-none focus:ring-2 focus:ring-cyan-400/30 transition-all duration-150">
              <span id="hobbies-display" class="text-sm truncate">Select interests...</span>
              <svg class="w-4 h-4 text-cyan-400 transform transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </button>
            <div id="hobbies-dropdown" class="absolute z-10 w-full mt-1 bg-gray-800 border border-gray-600 rounded-lg shadow-lg hidden max-h-40 overflow-y-auto">
              <label class="flex items-center px-3 py-2 hover:bg-gray-700 cursor-pointer">
                <input type="checkbox" value="chess" class="hobby-filter mr-2">
                <span>‚ôüÔ∏è Chess</span>
              </label>
              <label class="flex items-center px-3 py-2 hover:bg-gray-700 cursor-pointer">
                <input type="checkbox" value="programming" class="hobby-filter mr-2">
                <span>üíª Programming</span>
              </label>
              <label class="flex items-center px-3 py-2 hover:bg-gray-700 cursor-pointer">
                <input type="checkbox" value="music" class="hobby-filter mr-2">
                <span>üéµ Music</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Filter Results Summary -->
      <div id="filter-summary" class="mt-4 p-3 bg-gray-700/50 rounded-lg hidden">
        <div class="flex flex-wrap items-center gap-2">
          <span class="text-sm text-gray-300">Active filters:</span>
          <div id="active-filters" class="flex flex-wrap gap-1"></div>
        </div>
      </div>
    </div>

    <!-- Test Actions -->
    <div class="mb-6 p-4 bg-green-500/20 border border-green-400/30 rounded-xl">
      <h3 class="text-lg font-semibold text-green-300 mb-4">Test Actions</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <button onclick="testSubjectFilter()" class="px-4 py-2 bg-green-600 hover:bg-green-500 rounded-lg transition-all duration-300">Test Subject Filter</button>
        <button onclick="testAvailabilityFilter()" class="px-4 py-2 bg-blue-600 hover:bg-blue-500 rounded-lg transition-all duration-300">Test Availability Filter</button>
        <button onclick="testLanguageFilter()" class="px-4 py-2 bg-purple-600 hover:bg-purple-500 rounded-lg transition-all duration-300">Test Language Filter</button>
        <button onclick="testHobbyFilter()" class="px-4 py-2 bg-yellow-600 hover:bg-yellow-500 rounded-lg transition-all duration-300">Test Hobby Filter</button>
      </div>
    </div>

    <!-- Test Results -->
    <div id="test-results" class="p-4 bg-gray-800/50 rounded-xl">
      <h3 class="text-lg font-semibold text-gray-300 mb-4">Filter State Debug</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <h4 class="text-sm font-medium text-cyan-300 mb-2">Current Filter State:</h4>
          <pre id="filter-state" class="text-xs text-gray-400 bg-gray-900/50 p-3 rounded-lg overflow-auto">No filters applied</pre>
        </div>
        <div>
          <h4 class="text-sm font-medium text-cyan-300 mb-2">Recent Actions:</h4>
          <div id="action-log" class="text-xs text-gray-400 bg-gray-900/50 p-3 rounded-lg h-32 overflow-y-auto">Test initialized</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Mock currentLang variable
    let currentLang = 'en';
    
    // Mock advanced filters state  
    let advancedFilters = {
      subjects: [],
      availability: [],
      languages: [],
      hobbies: []
    };

    // Initialize advanced filter functionality
    function initAdvancedFilters() {
      console.log('Initializing advanced filters...');
      logAction('Initializing advanced filters...');
      
      // Initialize each multi-select dropdown
      initMultiSelectDropdown('subjects', 'subject-filter');
      initMultiSelectDropdown('availability', 'availability-filter');
      initMultiSelectDropdown('languages', 'language-filter');
      initMultiSelectDropdown('hobbies', 'hobby-filter');
      
      // Clear all filters button
      document.getElementById('clear-all-filters').addEventListener('click', clearAllFilters);
      
      // Close dropdowns when clicking outside
      document.addEventListener('click', (e) => {
        const dropdowns = ['subjects', 'availability', 'languages', 'hobbies'];
        dropdowns.forEach(type => {
          const dropdown = document.getElementById(`${type}-dropdown`);
          const button = document.getElementById(`${type}-dropdown-btn`);
          if (dropdown && button && !button.contains(e.target) && !dropdown.contains(e.target)) {
            dropdown.classList.add('hidden');
            button.querySelector('svg').classList.remove('rotate-180');
          }
        });
      });
      
      logAction('‚úÖ Filters initialized successfully');
      updateStatusDisplay('‚úÖ Filters initialized and ready for testing');
    }

    function initMultiSelectDropdown(filterType, checkboxClass) {
      const button = document.getElementById(`${filterType}-dropdown-btn`);
      const dropdown = document.getElementById(`${filterType}-dropdown`);
      const display = document.getElementById(`${filterType}-display`);
      
      if (!button || !dropdown || !display) {
        console.error(`Missing elements for ${filterType} filter`);
        return;
      }
      
      // Toggle dropdown on button click
      button.addEventListener('click', (e) => {
        e.stopPropagation();
        const isHidden = dropdown.classList.contains('hidden');
        
        // Close all other dropdowns
        ['subjects', 'availability', 'languages', 'hobbies'].forEach(type => {
          if (type !== filterType) {
            document.getElementById(`${type}-dropdown`).classList.add('hidden');
            document.getElementById(`${type}-dropdown-btn`).querySelector('svg').classList.remove('rotate-180');
          }
        });
        
        // Toggle current dropdown
        if (isHidden) {
          dropdown.classList.remove('hidden');
          button.querySelector('svg').classList.add('rotate-180');
          logAction(`üîΩ Opened ${filterType} dropdown`);
        } else {
          dropdown.classList.add('hidden');
          button.querySelector('svg').classList.remove('rotate-180');
          logAction(`üîº Closed ${filterType} dropdown`);
        }
      });
      
      // Handle checkbox changes
      const checkboxes = dropdown.querySelectorAll(`.${checkboxClass}`);
      checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', () => {
          updateFilterState(filterType, checkbox.value, checkbox.checked);
          updateDisplayText(filterType, display);
          updateFilterSummary();
          logAction(`${checkbox.checked ? '‚òëÔ∏è' : '‚òê'} ${filterType}: ${checkbox.value}`);
          updateDebugDisplay();
        });
      });
    }

    function updateFilterState(filterType, value, checked) {
      if (checked) {
        if (!advancedFilters[filterType].includes(value)) {
          advancedFilters[filterType].push(value);
        }
      } else {
        advancedFilters[filterType] = advancedFilters[filterType].filter(item => item !== value);
      }
      
      console.log(`Updated ${filterType} filters:`, advancedFilters[filterType]);
    }

    function updateDisplayText(filterType, display) {
      const selectedFilters = advancedFilters[filterType];
      const placeholders = {
        subjects: 'Select subjects...',
        availability: 'Select times...',
        languages: 'Select languages...',
        hobbies: 'Select interests...'
      };
      
      if (selectedFilters.length === 0) {
        display.textContent = placeholders[filterType];
        display.classList.remove('text-cyan-300');
        display.classList.add('text-gray-400');
      } else if (selectedFilters.length === 1) {
        display.textContent = selectedFilters[0];
        display.classList.add('text-cyan-300');
        display.classList.remove('text-gray-400');
      } else {
        display.textContent = `${selectedFilters.length} selected`;
        display.classList.add('text-cyan-300');
        display.classList.remove('text-gray-400');
      }
    }

    function updateFilterSummary() {
      const summary = document.getElementById('filter-summary');
      const activeFiltersContainer = document.getElementById('active-filters');
      
      const allActiveFilters = [
        ...advancedFilters.subjects.map(s => ({ type: 'subject', value: s })),
        ...advancedFilters.availability.map(a => ({ type: 'availability', value: a })),
        ...advancedFilters.languages.map(l => ({ type: 'language', value: l })),
        ...advancedFilters.hobbies.map(h => ({ type: 'hobby', value: h }))
      ];
      
      if (allActiveFilters.length === 0) {
        summary.classList.add('hidden');
        return;
      }
      
      summary.classList.remove('hidden');
      activeFiltersContainer.innerHTML = '';
      
      allActiveFilters.forEach(filter => {
        const tag = document.createElement('span');
        tag.className = 'inline-flex items-center gap-1 px-2 py-1 bg-cyan-500/20 text-cyan-300 rounded text-xs border border-cyan-400/30';
        
        const icons = {
          subject: 'üìö',
          availability: '‚è∞',
          language: 'üåç',
          hobby: 'üéØ'
        };
        
        tag.innerHTML = `
          ${icons[filter.type]} ${filter.value}
          <button onclick="removeFilter('${filter.type}', '${filter.value}')" class="ml-1 text-cyan-400 hover:text-white">√ó</button>
        `;
        
        activeFiltersContainer.appendChild(tag);
      });
    }

    function removeFilter(type, value) {
      const filterTypeMap = {
        subject: 'subjects',
        availability: 'availability',
        language: 'languages',
        hobby: 'hobbies'
      };
      
      const filterType = filterTypeMap[type];
      if (!filterType) return;
      
      // Remove from filter state
      advancedFilters[filterType] = advancedFilters[filterType].filter(item => item !== value);
      
      // Uncheck the corresponding checkbox
      const checkboxClass = {
        subjects: 'subject-filter',
        availability: 'availability-filter',
        languages: 'language-filter',
        hobbies: 'hobby-filter'
      };
      
      const checkbox = document.querySelector(`.${checkboxClass[filterType]}[value="${value}"]`);
      if (checkbox) {
        checkbox.checked = false;
      }
      
      // Update display and summary
      const display = document.getElementById(`${filterType}-display`);
      updateDisplayText(filterType, display);
      updateFilterSummary();
      logAction(`‚ùå Removed ${type}: ${value}`);
      updateDebugDisplay();
    }

    function clearAllFilters() {
      console.log('Clearing all filters...');
      logAction('üßπ Clearing all filters...');
      
      // Reset filter state
      advancedFilters = {
        subjects: [],
        availability: [],
        languages: [],
        hobbies: []
      };
      
      // Uncheck all checkboxes
      document.querySelectorAll('.subject-filter, .availability-filter, .language-filter, .hobby-filter').forEach(checkbox => {
        checkbox.checked = false;
      });
      
      // Reset display texts
      ['subjects', 'availability', 'languages', 'hobbies'].forEach(filterType => {
        const display = document.getElementById(`${filterType}-display`);
        updateDisplayText(filterType, display);
      });
      
      // Hide summary and update debug
      updateFilterSummary();
      updateDebugDisplay();
      logAction('‚úÖ All filters cleared');
    }

    // Test functions
    function testSubjectFilter() {
      logAction('üß™ Testing subject filter...');
      document.querySelector('.subject-filter[value="math"]').click();
      document.querySelector('.subject-filter[value="science"]').click();
      updateStatusDisplay('‚úÖ Subject filter test completed - selected Math and Science');
    }

    function testAvailabilityFilter() {
      logAction('üß™ Testing availability filter...');
      document.querySelector('.availability-filter[value="evening"]').click();
      document.querySelector('.availability-filter[value="weekends"]').click();
      updateStatusDisplay('‚úÖ Availability filter test completed - selected Evening and Weekends');
    }

    function testLanguageFilter() {
      logAction('üß™ Testing language filter...');
      document.querySelector('.language-filter[value="English"]').click();
      document.querySelector('.language-filter[value="Spanish"]').click();
      updateStatusDisplay('‚úÖ Language filter test completed - selected English and Spanish');
    }

    function testHobbyFilter() {
      logAction('üß™ Testing hobby filter...');
      document.querySelector('.hobby-filter[value="chess"]').click();
      document.querySelector('.hobby-filter[value="programming"]').click();
      updateStatusDisplay('‚úÖ Hobby filter test completed - selected Chess and Programming');
    }

    // Helper functions
    function logAction(message) {
      const log = document.getElementById('action-log');
      const timestamp = new Date().toLocaleTimeString();
      log.innerHTML += `<div>[${timestamp}] ${message}</div>`;
      log.scrollTop = log.scrollHeight;
    }

    function updateDebugDisplay() {
      const filterState = document.getElementById('filter-state');
      filterState.textContent = JSON.stringify(advancedFilters, null, 2);
    }

    function updateStatusDisplay(message) {
      const statusContent = document.getElementById('status-content');
      statusContent.innerHTML = `<p class="text-green-400">${message}</p>`;
    }

    // Initialize on load
    document.addEventListener('DOMContentLoaded', () => {
      initAdvancedFilters();
      updateDebugDisplay();
    });
  </script>
</body>
</html> 